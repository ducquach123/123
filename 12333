-- Mini Menu GUI Script
-- Đặt trong StarterGui hoặc StarterPlayerScripts (LocalScript)

local Players = game:GetService('Players')
local player = Players.LocalPlayer
local playerGui = player:WaitForChild('PlayerGui')

-- Tạo ScreenGui
local screenGui = Instance.new('ScreenGui')
screenGui.Name = 'MiniMenu'
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui

-- Tạo Frame chính
local mainFrame = Instance.new('Frame')
mainFrame.Name = 'MainFrame'
mainFrame.Size = UDim2.new(0, 200, 0, 165)
mainFrame.Position = UDim2.new(0, 10, 1, -175) -- Góc dưới trái
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
mainFrame.BorderSizePixel = 0
mainFrame.Parent = screenGui

-- Bo tròn góc
local corner = Instance.new('UICorner')
corner.CornerRadius = UDim.new(0, 10)
corner.Parent = mainFrame

-- Tiêu đề
local title = Instance.new('TextLabel')
title.Name = 'Title'
title.Size = UDim2.new(1, 0, 0, 30)
title.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
title.Text = 'Menu'
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.Font = Enum.Font.GothamBold
title.TextSize = 14
title.Parent = mainFrame

local titleCorner = Instance.new('UICorner')
titleCorner.CornerRadius = UDim.new(0, 10)
titleCorner.Parent = title

-- Nút 1: Xóa Avatar
local btnClearAvatar = Instance.new('TextButton')
btnClearAvatar.Name = 'ClearAvatarBtn'
btnClearAvatar.Size = UDim2.new(1, -20, 0, 35)
btnClearAvatar.Position = UDim2.new(0, 10, 0, 40)
btnClearAvatar.BackgroundColor3 = Color3.fromRGB(220, 50, 50)
btnClearAvatar.Text = 'Xóa Avatar'
btnClearAvatar.TextColor3 = Color3.fromRGB(255, 255, 255)
btnClearAvatar.Font = Enum.Font.Gotham
btnClearAvatar.TextSize = 13
btnClearAvatar.Parent = mainFrame

local btn1Corner = Instance.new('UICorner')
btn1Corner.CornerRadius = UDim.new(0, 6)
btn1Corner.Parent = btnClearAvatar

-- Nút 2: Spam Slap
local btnSpamSlap = Instance.new('TextButton')
btnSpamSlap.Name = 'SpamSlapBtn'
btnSpamSlap.Size = UDim2.new(1, -20, 0, 35)
btnSpamSlap.Position = UDim2.new(0, 10, 0, 80)
btnSpamSlap.BackgroundColor3 = Color3.fromRGB(50, 150, 220)
btnSpamSlap.Text = 'Spam Slap: OFF'
btnSpamSlap.TextColor3 = Color3.fromRGB(255, 255, 255)
btnSpamSlap.Font = Enum.Font.Gotham
btnSpamSlap.TextSize = 13
btnSpamSlap.Parent = mainFrame

local btn2Corner = Instance.new('UICorner')
btn2Corner.CornerRadius = UDim.new(0, 6)
btn2Corner.Parent = btnSpamSlap

-- Nút 3: Nửa Vời
local btnNuaVoi = Instance.new('TextButton')
btnNuaVoi.Name = 'NuaVoiBtn'
btnNuaVoi.Size = UDim2.new(1, -20, 0, 35)
btnNuaVoi.Position = UDim2.new(0, 10, 0, 120)
btnNuaVoi.BackgroundColor3 = Color3.fromRGB(150, 50, 220)
btnNuaVoi.Text = 'Nửa Vời: OFF'
btnNuaVoi.TextColor3 = Color3.fromRGB(255, 255, 255)
btnNuaVoi.Font = Enum.Font.Gotham
btnNuaVoi.TextSize = 13
btnNuaVoi.Parent = mainFrame

local btn3Corner = Instance.new('UICorner')
btn3Corner.CornerRadius = UDim.new(0, 6)
btn3Corner.Parent = btnNuaVoi

-- Biến spam
local isSpamming = false
local isNuaVoi = false
local spamConnection

-- Hàm xóa avatar
local function clearAvatar()
    player:ClearCharacterAppearance()
    print('Đã xóa avatar!')
end

-- TỰ ĐỘNG XÓA AVATAR KHI EXECUTE
if player.Character then
    clearAvatar()
end

-- Hàm tìm tool Slap
local function getSlapTool()
    local backpack = player:WaitForChild('Backpack')
    for _, item in pairs(backpack:GetChildren()) do
        if
            item:IsA('Tool') and string.find(string.lower(item.Name), 'slap')
        then
            return item
        end
    end

    -- Kiểm tra tool đang cầm
    local character = player.Character
    if character then
        for _, item in pairs(character:GetChildren()) do
            if
                item:IsA('Tool')
                and string.find(string.lower(item.Name), 'slap')
            then
                return item
            end
        end
    end
    return nil
end

-- Hàm spam slap (cầm liên tục)
local function startSpamSlap()
    task.spawn(function()
        while isSpamming do
            local character = player.Character
            if character then
                local humanoid = character:FindFirstChild('Humanoid')
                local tool = getSlapTool()

                if humanoid and tool then
                    -- Cầm tool lên và giữ liên tục
                    if tool.Parent == player.Backpack then
                        humanoid:EquipTool(tool)
                    end
                    task.wait(0.1)
                else
                    task.wait(0.5)
                end
            else
                task.wait(0.5)
            end
        end
    end)
end

-- Hàm nửa vời (cầm 1.3s rồi thả)
local function startNuaVoi()
    task.spawn(function()
        while isNuaVoi do
            local character = player.Character
            if character then
                local humanoid = character:FindFirstChild('Humanoid')
                local tool = getSlapTool()

                if humanoid and tool then
                    -- Cầm tool lên
                    if tool.Parent == player.Backpack then
                        humanoid:EquipTool(tool)
                    end

                    -- Giữ 1.3s
                    task.wait(1.3)

                    -- Thả tool xuống
                    if tool.Parent == character then
                        humanoid:UnequipTools()
                    end

                    -- Đợi trước khi lặp lại
                    task.wait(0.1)
                else
                    task.wait(0.5)
                end
            else
                task.wait(0.5)
            end
        end
    end)
end

local function stopSpamSlap()
    isSpamming = false
end

local function stopNuaVoi()
    isNuaVoi = false
end

-- Sự kiện nút 1: Xóa Avatar
btnClearAvatar.MouseButton1Click:Connect(function()
    clearAvatar()
    btnClearAvatar.BackgroundColor3 = Color3.fromRGB(100, 220, 100)
    task.wait(0.2)
    btnClearAvatar.BackgroundColor3 = Color3.fromRGB(220, 50, 50)
end)

-- Sự kiện nút 2: Spam Slap (Toggle)
btnSpamSlap.MouseButton1Click:Connect(function()
    isSpamming = not isSpamming

    if isSpamming then
        btnSpamSlap.Text = 'Spam Slap: ON'
        btnSpamSlap.BackgroundColor3 = Color3.fromRGB(50, 220, 100)
        startSpamSlap()
    else
        btnSpamSlap.Text = 'Spam Slap: OFF'
        btnSpamSlap.BackgroundColor3 = Color3.fromRGB(50, 150, 220)
        stopSpamSlap()
    end
end)

-- Sự kiện nút 3: Nửa Vời (Toggle)
btnNuaVoi.MouseButton1Click:Connect(function()
    isNuaVoi = not isNuaVoi

    if isNuaVoi then
        btnNuaVoi.Text = 'Nửa Vời: ON'
        btnNuaVoi.BackgroundColor3 = Color3.fromRGB(220, 50, 220)
        startNuaVoi()
    else
        btnNuaVoi.Text = 'Nửa Vời: OFF'
        btnNuaVoi.BackgroundColor3 = Color3.fromRGB(150, 50, 220)
        stopNuaVoi()
    end
end)

-- Sự kiện phím R: Toggle Nửa Vời
local UserInputService = game:GetService('UserInputService')
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then
        return
    end

    if input.KeyCode == Enum.KeyCode.R then
        isNuaVoi = not isNuaVoi

        if isNuaVoi then
            btnNuaVoi.Text = 'Nửa Vời: ON'
            btnNuaVoi.BackgroundColor3 = Color3.fromRGB(220, 50, 220)
            startNuaVoi()
        else
            btnNuaVoi.Text = 'Nửa Vời: OFF'
            btnNuaVoi.BackgroundColor3 = Color3.fromRGB(150, 50, 220)
            stopNuaVoi()
        end
    end
end)

print('Mini Menu loaded!')
